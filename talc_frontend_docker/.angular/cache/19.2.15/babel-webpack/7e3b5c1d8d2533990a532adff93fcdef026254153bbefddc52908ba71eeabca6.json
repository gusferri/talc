{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { HttpClientModule } from '@angular/common/http';\nimport { MatFormFieldModule } from '@angular/material/form-field';\nimport { MatInputModule } from '@angular/material/input';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatIconModule } from '@angular/material/icon';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/material/dialog\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@angular/material/snack-bar\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/input\";\nimport * as i7 from \"@angular/material/button\";\nimport * as i8 from \"@angular/material/icon\";\nexport let ChangePasswordDialogComponent = /*#__PURE__*/(() => {\n  class ChangePasswordDialogComponent {\n    constructor(dialogRef, http, snackBar, data) {\n      this.dialogRef = dialogRef;\n      this.http = http;\n      this.snackBar = snackBar;\n      this.data = data;\n      this.currentPassword = '';\n      this.newPassword = '';\n      this.confirmPassword = '';\n      this.username = '';\n      this.hideCurrentPassword = true;\n      this.hideNewPassword = true;\n      this.hideConfirmPassword = true;\n      this.username = data?.username || localStorage.getItem('username') || '';\n    }\n    guardar() {\n      if (this.newPassword !== this.confirmPassword) {\n        alert('Las contraseñas nuevas no coinciden');\n        return;\n      }\n      if (!this.currentPassword || !this.newPassword) {\n        alert('Todos los campos son obligatorios');\n        return;\n      }\n      if (!this.username) {\n        alert('Error: Usuario no identificado');\n        return;\n      }\n      const payload = {\n        username: this.username,\n        contrasena_actual: this.currentPassword,\n        nueva_contrasena: this.newPassword\n      };\n      console.log('Payload enviado al backend:', payload);\n      this.http.post(`${environment.apiBaseUrl}/cambiar-contrasena`, payload, {\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      }).subscribe({\n        next: response => {\n          this.snackBar.open('Contraseña actualizada exitosamente', 'Cerrar', {\n            duration: 3000,\n            horizontalPosition: 'center',\n            verticalPosition: 'top'\n          });\n          setTimeout(() => {\n            localStorage.clear();\n            this.dialogRef.close(true);\n            window.location.href = '/login';\n          }, 1000);\n        },\n        error: err => {\n          console.error(err);\n          alert('Error al actualizar la contraseña');\n        }\n      });\n    }\n    cancelar() {\n      this.dialogRef.close(null);\n    }\n    static {\n      this.ɵfac = function ChangePasswordDialogComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || ChangePasswordDialogComponent)(i0.ɵɵdirectiveInject(i1.MatDialogRef), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.MatSnackBar), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: ChangePasswordDialogComponent,\n        selectors: [[\"app-change-password-dialog\"]],\n        decls: 36,\n        vars: 15,\n        consts: [[1, \"dialog-container\"], [\"mat-dialog-title\", \"\", 1, \"dialog-title\"], [1, \"password-form\", 3, \"ngSubmit\"], [\"appearance\", \"outline\", 1, \"full-width\"], [\"matInput\", \"\", \"name\", \"currentPassword\", \"required\", \"\", \"placeholder\", \"Ingrese su contrase\\u00F1a actual\", 3, \"ngModelChange\", \"type\", \"ngModel\"], [\"mat-icon-button\", \"\", \"matSuffix\", \"\", 3, \"click\"], [\"matInput\", \"\", \"name\", \"newPassword\", \"required\", \"\", \"placeholder\", \"Ingrese su nueva contrase\\u00F1a\", 3, \"ngModelChange\", \"type\", \"ngModel\"], [\"matInput\", \"\", \"name\", \"confirmPassword\", \"required\", \"\", \"placeholder\", \"Confirme su nueva contrase\\u00F1a\", 3, \"ngModelChange\", \"type\", \"ngModel\"], [\"mat-dialog-actions\", \"\", 1, \"dialog-actions\"], [\"mat-raised-button\", \"\", \"color\", \"primary\", \"type\", \"submit\", 1, \"action-button\", \"update-button\"], [\"mat-raised-button\", \"\", \"color\", \"warn\", \"type\", \"button\", 1, \"action-button\", \"cancel-button\", 3, \"click\"]],\n        template: function ChangePasswordDialogComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1)(2, \"mat-icon\");\n            i0.ɵɵtext(3, \"lock_reset\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(4, \" Cambiar Contrase\\u00F1a \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"form\", 2);\n            i0.ɵɵlistener(\"ngSubmit\", function ChangePasswordDialogComponent_Template_form_ngSubmit_5_listener() {\n              return ctx.guardar();\n            });\n            i0.ɵɵelementStart(6, \"mat-form-field\", 3)(7, \"mat-label\");\n            i0.ɵɵtext(8, \"Contrase\\u00F1a Actual\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(9, \"input\", 4);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ChangePasswordDialogComponent_Template_input_ngModelChange_9_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.currentPassword, $event) || (ctx.currentPassword = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function ChangePasswordDialogComponent_Template_button_click_10_listener() {\n              return ctx.hideCurrentPassword = !ctx.hideCurrentPassword;\n            });\n            i0.ɵɵelementStart(11, \"mat-icon\");\n            i0.ɵɵtext(12);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(13, \"mat-form-field\", 3)(14, \"mat-label\");\n            i0.ɵɵtext(15, \"Nueva Contrase\\u00F1a\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(16, \"input\", 6);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ChangePasswordDialogComponent_Template_input_ngModelChange_16_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.newPassword, $event) || (ctx.newPassword = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function ChangePasswordDialogComponent_Template_button_click_17_listener() {\n              return ctx.hideNewPassword = !ctx.hideNewPassword;\n            });\n            i0.ɵɵelementStart(18, \"mat-icon\");\n            i0.ɵɵtext(19);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(20, \"mat-form-field\", 3)(21, \"mat-label\");\n            i0.ɵɵtext(22, \"Confirmar Nueva Contrase\\u00F1a\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"input\", 7);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function ChangePasswordDialogComponent_Template_input_ngModelChange_23_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.confirmPassword, $event) || (ctx.confirmPassword = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(24, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function ChangePasswordDialogComponent_Template_button_click_24_listener() {\n              return ctx.hideConfirmPassword = !ctx.hideConfirmPassword;\n            });\n            i0.ɵɵelementStart(25, \"mat-icon\");\n            i0.ɵɵtext(26);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(27, \"div\", 8)(28, \"button\", 9)(29, \"mat-icon\");\n            i0.ɵɵtext(30, \"update\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(31, \" Actualizar \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(32, \"button\", 10);\n            i0.ɵɵlistener(\"click\", function ChangePasswordDialogComponent_Template_button_click_32_listener() {\n              return ctx.cancelar();\n            });\n            i0.ɵɵelementStart(33, \"mat-icon\");\n            i0.ɵɵtext(34, \"cancel\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵtext(35, \" Cancelar \");\n            i0.ɵɵelementEnd()()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(9);\n            i0.ɵɵproperty(\"type\", ctx.hideCurrentPassword ? \"password\" : \"text\");\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.currentPassword);\n            i0.ɵɵadvance();\n            i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx.hideCurrentPassword);\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.hideCurrentPassword ? \"visibility_off\" : \"visibility\");\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"type\", ctx.hideNewPassword ? \"password\" : \"text\");\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.newPassword);\n            i0.ɵɵadvance();\n            i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx.hideNewPassword);\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.hideNewPassword ? \"visibility_off\" : \"visibility\");\n            i0.ɵɵadvance(4);\n            i0.ɵɵproperty(\"type\", ctx.hideConfirmPassword ? \"password\" : \"text\");\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.confirmPassword);\n            i0.ɵɵadvance();\n            i0.ɵɵattribute(\"aria-label\", \"Hide password\")(\"aria-pressed\", ctx.hideConfirmPassword);\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.hideConfirmPassword ? \"visibility_off\" : \"visibility\");\n          }\n        },\n        dependencies: [CommonModule, FormsModule, i4.ɵNgNoValidate, i4.DefaultValueAccessor, i4.NgControlStatus, i4.NgControlStatusGroup, i4.RequiredValidator, i4.NgModel, i4.NgForm, HttpClientModule, MatFormFieldModule, i5.MatFormField, i5.MatLabel, i5.MatSuffix, MatInputModule, i6.MatInput, MatButtonModule, i7.MatButton, i7.MatIconButton, MatIconModule, i8.MatIcon],\n        styles: [\".dialog-container{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:24px;width:400px;max-width:90vw}.dialog-title{display:flex;align-items:center;gap:12px;text-align:center;margin-bottom:24px;color:#333;font-weight:600;font-size:20px}.dialog-title mat-icon{color:#aa262b;font-size:24px}.password-form{display:flex;flex-direction:column;width:100%;gap:16px}.password-form .full-width{width:100%}.dialog-actions{display:flex;justify-content:center;gap:16px;margin-top:24px;width:100%}.dialog-actions .action-button{flex:1;height:44px;font-weight:500;border-radius:8px;transition:all .3s ease}.dialog-actions .action-button mat-icon{margin-right:8px}.dialog-actions .action-button.update-button{background:linear-gradient(135deg,#aa262b,#c62828);color:#fff}.dialog-actions .action-button.update-button:hover{transform:translateY(-2px);box-shadow:0 6px 16px #aa262b4d}.dialog-actions .action-button.cancel-button{background:#f5f5f5;color:#666}.dialog-actions .action-button.cancel-button:hover{background:#e0e0e0;transform:translateY(-2px)}@media (max-width: 480px){.dialog-container{padding:16px;width:100%}.dialog-actions{flex-direction:column;gap:12px}.dialog-actions .action-button{width:100%}}\\n\"],\n        encapsulation: 2\n      });\n    }\n  }\n  return ChangePasswordDialogComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}